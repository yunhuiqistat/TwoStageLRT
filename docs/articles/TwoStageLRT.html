<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TwoStageLRT â€¢ TwoStageLRT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TwoStageLRT">
<meta property="og:description" content="TwoStageLRT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TwoStageLRT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/TwoStageLRT.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/yunhuiqistat/TwoStageLRT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TwoStageLRT</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yunhuiqistat/TwoStageLRT/blob/HEAD/vignettes/TwoStageLRT.Rmd" class="external-link"><code>vignettes/TwoStageLRT.Rmd</code></a></small>
      <div class="hidden name"><code>TwoStageLRT.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yunhuiqistat/TwoStageLRT" class="external-link">TwoStageLRT</a></span><span class="op">)</span></span></code></pre></div>
<p>This file shows the simulation in the original paper under a simple
setting.</p>
<div class="section level2">
<h2 id="simulation-steps">Simulation steps<a class="anchor" aria-label="anchor" href="#simulation-steps"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Simulate rate for Gamma distribution: We begin by simulating
gene-wise rate parameters from a uniform distribution with range from
0.05 to 0.2 to ensure that the mean expression level for each gene
remains consistent across families, but varies across different
genes.</p></li>
<li><p>Simulate parental mean expression: For each gene-family
combination, we simulate the mean of the female variety from a gamma
distribution with a shape parameter of 30 and the simulated gene-wise
rate parameter. The male mean matrix is set to be identical to the
female mean matrix.</p></li>
<li>
<p>Simulate hybrid mean expression: We specify which gene-family
combinations exhibit MPH, i.e., the MPH pattern, and the MPH strength,
i.e., MPH ratio which is defined as <span class="math inline">\(\delta_{gh}=\mu_{gh3}/(\frac{\mu_{gh1}+\mu_{gh2}}{2})-1\)</span>.
Inspired by the real data example in the original paper where there is
considerable variation in the proportions of MPH hybrids between
different genes, we aim to simulate some genes that tend to exhibit MPH
in most families and others exhibit MPH in only a few families. The
percentage of MPH families is set to be either 90% for genes tending to
exhibit MPH or 5% for genes tending not to exhibit MPH.</p>
<p>Regarding the MPH ratio, we introduce positive heterosis (<span class="math inline">\(\delta_{gh}&gt;0\)</span>), negative heterosis
(<span class="math inline">\(\delta_{gh}&lt;0\)</span>), and
non-heterosis (<span class="math inline">\(\delta_{gh}=0\)</span>)
gene-family combinations into our simulation. We consider signal
strength pairs: <span class="math inline">\(\delta_{gh} = 2\)</span> for
positive heterosis and <span class="math inline">\(\delta_{gh} =
-2/3\)</span> for negative heterosis.</p>
</li>
<li><p>Simulate dispersion parameters: We calculate the median
mid-parent mean for each gene, denoted as <span class="math inline">\(mp\)</span>. The dispersion parameter is then set
to be <span class="math inline">\(mp^{-1/6}-0.3\)</span> with the
addition of a random sample <span class="math inline">\(\epsilon\)</span> from a normal distribution with
mean 0 and standard deviation 0.002. Although rare, negative values of
dispersion are replaced by 0.</p></li>
<li><p>imulate values for normalization factors: The normalization
factors are simulated from a uniform distribution with range from 0.8 to
1.3.</p></li>
<li><p>Simulate count table for female, male and hybird: Using the
female/male/hybrid mean matrix, dispersion for each gene and
normalization factors for each sample, we simulate the
female/male/hybird count table with dimensions <span class="math inline">\(G = 100 \times H = 150\)</span> from a negative
binomial distribution.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h2>
<p>Just for illustration purpose, 3 datasets are generated following
simulation steps above and 2sLRT is applied to each of them. To compare
with, in addition to 2sLRT, we also performed the naive estimation
method (denoted as Estimation) which rank the gene-family combination by
the absolute values of MPH ratio estimation, and Poisson likelihood
ratio test (denote as Poisson) for detection of MPH.</p>
<p>To conduct 2sLRT, we specify the hyper-parameters to be: thee minimum
number of null families for gene dispersion estimation <span class="math inline">\(N_0\)</span> is set to be 10, and the number of
gene clusters is 2.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_female_dense</span> <span class="op">&lt;-</span> <span class="st">"matrix(rgamma(case$n_genes*case$n_families, shape = 30, rate=runif(case$n_genes, 0.05, 0.2)),nrow=case$n_genes, ncol=case$n_families)"</span></span>
<span></span>
<span><span class="va">effect_factor_dense</span> <span class="op">&lt;-</span> <span class="st">"rbind(matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.05)==1, case$sig_pos, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.05)==1, case$sig_neg, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.9)==1, case$sig_pos, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.9)==1, case$sig_neg, 0),nrow = case$n_genes/4, ncol = case$n_families))"</span></span>
<span></span>
<span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_genes <span class="op">=</span> <span class="fl">100</span>, n_families <span class="op">=</span> <span class="fl">150</span>,</span>
<span>             sig_pos <span class="op">=</span> <span class="fl">2</span>, sig_neg <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>             mu_female <span class="op">=</span> <span class="va">mu_female_dense</span>,</span>
<span>             mu_male <span class="op">=</span> <span class="st">"case$mu_female"</span>, </span>
<span>             effect_factor <span class="op">=</span> <span class="va">effect_factor_dense</span>,</span>
<span>             female_norm_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.3</span><span class="op">)</span>, </span>
<span>             male_norm_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.3</span><span class="op">)</span>, </span>
<span>             hybrid_norm_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.3</span><span class="op">)</span>,</span>
<span>             MP_DISP_func <span class="op">=</span> <span class="st">"inverse_func"</span>, true_disp <span class="op">=</span> <span class="cn">FALSE</span>, true_norm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             n_fam_thres <span class="op">=</span> <span class="fl">10</span>, gene_groups_no <span class="op">=</span> <span class="fl">2</span>, repetition <span class="op">=</span> <span class="fl">3</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, filename <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">case</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_genes</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_families</span></span>
<span><span class="co">#&gt; [1] 150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sig_pos</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sig_neg</span></span>
<span><span class="co">#&gt; [1] -0.6666667</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mu_female</span></span>
<span><span class="co">#&gt; [1] "matrix(rgamma(case$n_genes*case$n_families, shape = 30, rate=runif(case$n_genes, 0.05, 0.2)),nrow=case$n_genes, ncol=case$n_families)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mu_male</span></span>
<span><span class="co">#&gt; [1] "case$mu_female"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $effect_factor</span></span>
<span><span class="co">#&gt; [1] "rbind(matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.05)==1, case$sig_pos, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.05)==1, case$sig_neg, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.9)==1, case$sig_pos, 0),nrow = case$n_genes/4, ncol = case$n_families), matrix(ifelse(rbinom(case$n_genes/4*case$n_families, 1, 0.9)==1, case$sig_neg, 0),nrow = case$n_genes/4, ncol = case$n_families))"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $female_norm_factor</span></span>
<span><span class="co">#&gt; [1] 0.8 1.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $male_norm_factor</span></span>
<span><span class="co">#&gt; [1] 0.8 1.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hybrid_norm_factor</span></span>
<span><span class="co">#&gt; [1] 0.8 1.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MP_DISP_func</span></span>
<span><span class="co">#&gt; [1] "inverse_func"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $true_disp</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $true_norm</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_fam_thres</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gene_groups_no</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $repetition</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plot</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filename</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>To visualize the simulation results, for 2sLRT and Poisson LRT with
p-values, we present the qqplot to compare the quantiles of p-values for
non-MPH gene-family combinations among all repetitions versus quantiles
of Uniform(0,1) distribution. We also report the FDR averaged over
repetitions changing over nominal FDR within <span class="math inline">\((0,0.2)\)</span> and at 0.05 nominal FDR. For each
of the three methods, an average Receiver Operating Characteristic (ROC)
curve over repetitions is presented, along with the average partial Area
Under Curve (AUC) for false positive rate within range <span class="math inline">\((0,0.2)\)</span>. In addition, to evaluate the
dispersion estimation from 2sLRT, we also present the scatter plot of
estimated gene-wise dispersion parameters (averaged over datasets)
versus the corresponding true values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">case</span><span class="op">$</span><span class="va">mu_female</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">case</span><span class="op">$</span><span class="va">mu_female</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">mu_female</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">case</span><span class="op">$</span><span class="va">mu_male</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">case</span><span class="op">$</span><span class="va">mu_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">mu_male</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">case</span><span class="op">$</span><span class="va">effect_factor</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="va">case</span><span class="op">$</span><span class="va">effect_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">effect_factor</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Hetero_pip_2sLRT.html">Hetero_pip_2sLRT</a></span><span class="op">(</span>n_genes <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">n_genes</span>, n_families <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">n_families</span>,</span>
<span>                        mu_female <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">mu_female</span>, mu_male <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">mu_male</span>,</span>
<span>                        effect_factor <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">effect_factor</span>,</span>
<span>                        female_norm_factor <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">female_norm_factor</span>,</span>
<span>                        male_norm_factor <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">male_norm_factor</span>,</span>
<span>                        hybrid_norm_factor <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">hybrid_norm_factor</span>,</span>
<span>                        true_norm <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">true_norm</span>,</span>
<span>                        MP_DISP_func <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">MP_DISP_func</span>, true_disp <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">true_disp</span>,</span>
<span>                        n_fam_thres <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">n_fam_thres</span>,</span>
<span>                        gene_groups_no <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">gene_groups_no</span>,</span>
<span>                        repetition <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">repetition</span>, plot <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">plot</span>,</span>
<span>                        filename <span class="op">=</span> <span class="va">case</span><span class="op">$</span><span class="va">filename</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use provided mean count matrix for female. </span></span>
<span><span class="co">#&gt; Use provided mean count matrix for male. </span></span>
<span><span class="co">#&gt; Use provided effect factor matrix for hybrid. </span></span>
<span><span class="co">#&gt; Use simulated norm factors from uniform. </span></span>
<span><span class="co">#&gt; Use simulated norm factors from uniform. </span></span>
<span><span class="co">#&gt; Use simulated norm factors from uniform. </span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.04086 0.07895 0.09919 0.09617 0.11601 0.13590 </span></span>
<span><span class="co">#&gt; Use DESeq estimated normalization factors. </span></span>
<span><span class="co">#&gt; Gene clusters size: </span></span>
<span><span class="co">#&gt; jacc_clust</span></span>
<span><span class="co">#&gt;  1  2 </span></span>
<span><span class="co">#&gt; 45  4 </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 1 the number of families is 10 , number of genes is  45  </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 2 the number of families is 12 , number of genes is  4  </span></span>
<span><span class="co">#&gt; Dispersion estimation summary:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt; 0.02509 0.08123 0.10313 0.10154 0.11971 0.20538      51 </span></span>
<span><span class="co">#&gt; Output is from NB LRT for heterosis. </span></span>
<span><span class="co">#&gt; Proportion of Failure NB LRT is 0 </span></span>
<span><span class="co">#&gt; Use DESeq estimated normalization factors. </span></span>
<span><span class="co">#&gt; Gene clusters size: </span></span>
<span><span class="co">#&gt; jacc_clust</span></span>
<span><span class="co">#&gt;  1  2 </span></span>
<span><span class="co">#&gt; 45  3 </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 1 the number of families is 11 , number of genes is  45  </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 2 the number of families is 15 , number of genes is  3  </span></span>
<span><span class="co">#&gt; Dispersion estimation summary:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt; 0.03026 0.08681 0.11879 0.11720 0.14527 0.19368      52 </span></span>
<span><span class="co">#&gt; Output is from NB LRT for heterosis. </span></span>
<span><span class="co">#&gt; Proportion of Failure NB LRT is 0 </span></span>
<span><span class="co">#&gt; Use DESeq estimated normalization factors. </span></span>
<span><span class="co">#&gt; Gene clusters size: </span></span>
<span><span class="co">#&gt; jacc_clust</span></span>
<span><span class="co">#&gt;  1  2 </span></span>
<span><span class="co">#&gt; 43  4 </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 1 the number of families is 10 , number of genes is  43  </span></span>
<span><span class="co">#&gt; Dispersion estimation for cluster 2 the number of families is 20 , number of genes is  4  </span></span>
<span><span class="co">#&gt; Dispersion estimation summary:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt; 0.03295 0.08444 0.10479 0.11025 0.13048 0.25934      53 </span></span>
<span><span class="co">#&gt; Output is from NB LRT for heterosis. </span></span>
<span><span class="co">#&gt; Proportion of Failure NB LRT is 0 </span></span>
<span><span class="co">#&gt; The summary over all genes of SD(dispersion estimation across repetitions for each gene) </span></span>
<span><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span><span class="co">#&gt; 0.0006358 0.0094856 0.0167825 0.0230905 0.0296916 0.1029239 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  CCC between pvalue and Uniform quantiles, NB=0.9989, Pois=0.3614</span></span>
<span><span class="co">#&gt;  FDR at alpha=0.05 is, NB=0.0345, Pois=0.4357</span></span>
<span><span class="co">#&gt;  TPR at alpha=0.05 is, NB=0.5666, Pois=0.9889</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  NB: average AUC = 0.9411  SE = 0.0037 </span></span>
<span><span class="co">#&gt; Pois: average AUC = 0.9333  SE = 0.0033 </span></span>
<span><span class="co">#&gt; Naive: average AUC = 0.9185  SE = 0.0031 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  NB: average partial AUC = 0.8834  SE = 0.0059 </span></span>
<span><span class="co">#&gt; Pois: average partial AUC = 0.8744  SE = 0.005 </span></span>
<span><span class="co">#&gt; Naive: average partial AUC = 0.8186  SE = 0.005</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="TwoStageLRT_files/figure-html/sim%20results-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yunhui Qi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
